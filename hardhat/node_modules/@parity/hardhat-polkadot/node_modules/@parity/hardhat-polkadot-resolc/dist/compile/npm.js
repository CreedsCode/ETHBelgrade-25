"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.compileWithNpm = compileWithNpm;
const child_process_1 = require("child_process");
const util_1 = require("util");
const resolc_1 = require("@parity/resolc");
const _exec = (0, util_1.promisify)(child_process_1.exec);
async function compileWithNpm(input, config) {
    const sources = (0, resolc_1.resolveInputs)(input.sources);
    if (!!config.settings?.optimizer?.enabled) {
        const optimizer = {
            enabled: true,
            mode: config.settings?.optimizer?.parameters,
            fallback_to_optimizing_for_size: config.settings?.optimizer?.fallbackOz,
            runs: config.settings?.optimizer?.runs
        };
        const out = (0, resolc_1.compile)(sources, { optimizer });
        return out;
    }
    else if (config.settings?.optimizer?.enabled === false) {
        const optimizer = {
            enabled: false,
        };
        const out = (0, resolc_1.compile)(sources, { optimizer });
        return out;
    }
    else {
        const out = (0, resolc_1.compile)(sources);
        return out;
    }
}
//# sourceMappingURL=npm.js.map